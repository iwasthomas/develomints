<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="gosu">
	<insert id="insertGosu" parameterType="g">
		insert into gosu
		values(gosu_seq.nextval,#{gsouNo},#{gosuTitle},#{gosuSelf},#{gosuExplain},#{gosuAct},#{gosuCost},to_char(sysdate,'yyyy-mm-dd'))
		<selectKey resultType="_int" order="AFTER"
			keyProperty="ggsouNo">
			select max(ggosu_no) from gosu
		</selectKey>
	</insert>
	<insert id="insertGPhoto" parameterType="gph">
		insert into gosu_photo
		values(gosu_gph.nextval,#{ggsouNo},#{photoFilepath})
	</insert>
	<insert id="insertGProject" parameterType="gpr">
		insert into
		gosu_project
		values(gosu_gpr.nextval,#{ggsouNo},#{gprojectTitle},#{gprojectContent},#{gprojectFilepath})
	</insert>
	<select id="gosuList" resultType="g">
		select * from (select rownum as
		rnum , r.* from (
		select
		ggosu_no as ggsouNo,
		gosu_no as gsouNo,
		gosu_title as gosuTitle,
		gosu_self as gosuSelf,
		gosu_explain as
		gosuExplain,
		gosu_act as gosuAct,
		gosu_cost as gosuCost,
		gosu_date as
		gosuDate
		from gosu
		order by 1 desc )r)rr
	</select>
	<select id="getGosuId" parameterType="_int" resultType="string">
		select
		member_id as gosuId
		from member where member_no = #{gosuNo}
	</select>
	<select id="getGosuId2" parameterType="_int" resultType="string">
		select
		member_id as gosuId
		from member where member_no = (select
		gosu_no
		from
		gosu where
		ggosu_no = #{ggosuNo})
	</select>
	<select id="getGosuImg" parameterType="_int" resultType="string">
		select
		filepath as gosuImg
		from member where member_no = #{gosuNo}
	</select>
	<select id="selectGosuOne" parameterType="_int" resultType="g">
		select
		ggosu_no as ggsouNo,
		gosu_no as gsouNo,
		gosu_title as gosuTitle,
		gosu_self as gosuSelf,
		gosu_explain as gosuExplain,
		gosu_act as gosuAct,
		gosu_cost as gosuCost,
		gosu_date as gosuDate
		from gosu where ggosu_no =
		#{ggosuNo}
	</select>
	<select id="selectGosuProjectList" parameterType="_int"
		resultType="gpr">
		select
		gproject_no as gprojectNo,
		ggosu_no as ggsouNo,
		gproject_title as gprojectTitle,
		gproject_content as gprojectContent,
		filepath as gprojectFilepath
		from gosu_project where ggosu_no =
		#{ggsouNo}
	</select>
	<select id="selectGosuPhotoList" parameterType="_int"
		resultType="gph">
		select
		file_no as fileNo,
		ggosu_no as ggsouNo,
		filepath as
		photoFilepath
		from gosu_photo where ggosu_no = #{ggsouNo}
	</select>
	<insert id="insertGosuNotice" parameterType="gn">
		insert into
		gosu_notice
		values(gosu_n_seq.nextval,#{writeId},#{gnoticeTitle},#{gnoticeContent},#{gnoticePhoto},to_char(sysdate,'yyyy-mm-dd'))
	</insert>
	<select id="selectGosuNoticeOne" parameterType="_int"
		resultType="gn">
		select
		gnotice_no as gnoticeNo,
		member_id as writeId,
		gnotice_title as gnoticeTitle,
		gnotice_content as gnoticeContent,
		gnotice_photo as gnoticePhoto,
		gnotice_date as gnoticeDate
		from
		gosu_notice where gnotice_no = #{gnoticeNo}
	</select>
	<select id="selectGosuNoticeList" resultType="gn">

		select * from
		(select rownum as rnum , r.*
		from (
		select
		gnotice_no as gnoticeNo,
		member_id as writeId,
		gnotice_title as gnoticeTitle,
		gnotice_content as
		gnoticeContent,
		gnotice_photo as gnoticePhoto,
		gnotice_date as
		gnoticeDate
		from gosu_notice order by 1 desc )r)rr
	</select>
	<select id="getGosuImg2" parameterType="string"
		resultType="string">
		select
		filepath as writeImg
		from member where member_id =
		#{writeId}
	</select>
	<select id="selectGosuNoticeList2" resultType="gn">
		select * from
		(select rownum as rnum , r.*
		from (
		select
		gnotice_no as gnoticeNo,
		gnotice_photo as gnoticePhoto
		from gosu_notice order by 1
		desc )r)rr
		where rnum between 1 and 6
	</select>
	<select id="selectNewGosuList" resultType="g">
		select * from (select
		rownum as rnum , r.* from (select
		member_no as gosuNo,
		member_id as
		gosuId,
		filepath as gosuImg
		from member where
		member_type=2 order by 1
		desc )r)rr where rnum between 1
		and 4
	</select>

	<select id="selectGosuCount" resultType="_int">
		select
		count(*)
		from
		member where member_type=2
	</select>
	<select id="selectGProject" parameterType="_int"
		resultType="gpr">
		select
		gproject_no as gprojectNo,
		ggosu_no as ggsouNo,
		gproject_title as gprojectTitle,
		gproject_content as gprojectContent,
		filepath as gprojectFilepath
		from gosu_project where gproject_no =
		#{gNo}
	</select>

	<insert id="insertGosuFeedback" parameterType="gf">
		insert into
		gosu_feedback
		values(GOSU_FB_SEQ.nextval,#{ggosuNo},#{feedbackContent},#{feedbackTitle},to_char(sysdate,'yyyy-mm-dd'),1,#{memberId})
		<selectKey resultType="_int" order="AFTER"
			keyProperty="feedbackNo">
			select max(FEEDBACK_NO) from gosu_feedback
		</selectKey>
	</insert>

	<select id="selectFeedbackOne" parameterType="_int"
		resultType="gf">
		select
		FEEDBACK_NO as feedbackNo,
		GGOSU_NO as ggosuNo,
		FEEDBACK_CONTENT as feedbackContent,
		FEEDBACK_TITLE as feedbackTitle,
		FEEDBACK_DATE as feedbackDate,
		FEEDBACK_NUM as feedbackNum,
		MEMBER_ID as
		memberId
		from
		gosu_feedback where FEEDBACK_NO = #{fbNo}
	</select>
	<select id="selectGosuFeedbackList" resultType="gf">
		select
		FEEDBACK_NO as feedbackNo,
		GGOSU_NO as ggosuNo,
		FEEDBACK_CONTENT as
		feedbackContent,
		FEEDBACK_TITLE as feedbackTitle,
		FEEDBACK_DATE as
		feedbackDate,
		FEEDBACK_NUM as feedbackNum,
		MEMBER_ID as memberId
		from
		gosu_feedback where MEMBER_ID = #{memberId}
	</select>

	<insert id="insertGosuTalk" parameterType="gt">
		insert into
		gosu_talk
		values(gosu_t_SEQ.nextval,#{feedbackNo},#{writer},#{talkContent},to_char(sysdate,'yyyy-mm-dd'),#{filepath},#{filename})

	</insert>

	<update id="updateFeedbackNum" parameterType="_int">
		update
		gosu_feedback set
		FEEDBACK_NUM = 2 where FEEDBACK_NO = #{feedbackNo}
	</update>
	<select id="selectGosuTalkList" parameterType="_int"
		resultType="gt">
		select
		TALK_NO as talkNo,
		FEEDBACK_NO as feedbackNo,
		WRITER as
		writer,
		TALK_CONTENT as talkContent,
		TALK_DATE as talkDate,
		FILEPATH,
		FILENAME
		from
		gosu_talk where FEEDBACK_NO = #{fbNo}
	</select>
	<select id="selectGosuFeedbackList2" parameterType="string"
		resultType="gf">
		select
		FEEDBACK_NO as feedbackNo,
		GGOSU_NO as ggosuNo,
		FEEDBACK_CONTENT as
		feedbackContent,
		FEEDBACK_TITLE as feedbackTitle,
		FEEDBACK_DATE as
		feedbackDate,
		FEEDBACK_NUM as feedbackNum,
		MEMBER_ID as
		memberId
		from
		gosu_feedback
		where ggosu_no=
		(select ggosu_no from gosu
		where
		gosu_no = (select member_no
		from member where
		member_id=#{memberId}))
	</select>
	<update id="talkStop" parameterType="_int">
		update
		gosu_feedback set
		FEEDBACK_NUM = 3 where FEEDBACK_NO = #{feedbackNo}
	</update>
	<select id="selectMemberId" parameterType="_int"
		resultType="String">
		select
		MEMBER_ID as memberId
		from
		gosu_feedback where
		FEEDBACK_NO = #{feedbackNo}
	</select>
	<select id="selectgosuWriteList" parameterType="string"
		resultType="g">
		select
		ggosu_no as ggsouNo,
		gosu_no as gsouNo,
		gosu_title as
		gosuTitle,
		gosu_self as gosuSelf,
		gosu_explain as
		gosuExplain,
		gosu_act as
		gosuAct,
		gosu_cost as gosuCost,
		gosu_date as
		gosuDate
		from(select * from
		gosu) where gosu_no=
		(select
		member_no from member where
		member_id=#{memberId})

	</select>
	<insert id="insertGosuRequest" parameterType="gr">
		insert into
		gosu_request
		values(GOSU_REQUEST_SEQ.nextval,#{requestWriterNo},#{requestContent1},#{requestContent2},#{requestContent3},#{requestContent4},#{requestContent5},#{requestContent6},#{requestContent7},to_char(sysdate,'yyyy-mm-dd'))

	</insert>
	<select id="selectMemberRequestList" resultType="gr">
		select
		REQUEST_NO as requestNo,
		REQUEST_WRITER_NO as requestWriterNo,
		REQUEST_DATE as requsetDate
		from gosu_request
	</select>
	<select id="selectGosuRequestContent" parameterType="_int"
		resultType="gr">
		select
		REQUEST_NO as requestNo,
		REQUEST_WRITER_NO as requestWriterNo,
		REQUEST_CONTENT1 as requestContent1,
		REQUEST_CONTENT2 as requestContent2,
		REQUEST_CONTENT3 as requestContent3,
		REQUEST_CONTENT4 as requestContent4,
		REQUEST_CONTENT5 as requestContent5,
		REQUEST_CONTENT6 as requestContent6,
		REQUEST_CONTENT7 as requestContent7,
		REQUEST_DATE as requsetDate
		from gosu_request where REQUEST_NO = #{mrn}
	</select>
</mapper>
